select_lapack	insert into select_lapack_out (id_instance, id_experiment, id_activity, adjacency, laplacian, slaplacian, adjacencyb, laplacianb, slaplacianb, optifunc, caixa1, gorder, mindegree, maxdegree, trianglefree, allowdiscgraphs, biptonly, g6file, g6fileid, g6splitedfile, maxresults) select %ID_PIP%, %ID_EXP%, %ID_ACT%, awk_out.adjacency, awk_out.laplacian, awk_out.slaplacian, awk_out.adjacencyb, awk_out.laplacianb, awk_out.slaplacianb, awk_out.optifunc, awk_out.caixa1, awk_out.gorder, awk_out.mindegree, awk_out.maxdegree, awk_out.trianglefree, awk_out.allowdiscgraphs, awk_out.biptonly, awk_out.g6file, awk_out.g6fileid, awk_out.g6splitedfile, awk_out.maxresults from awk_out where awk_out.id_experiment = %ID_EXP% and ( awk_out.optifunc like '%lambda%' or awk_out.optifunc like '%mu%' or awk_out.optifunc like '%q!_%' ESCAPE '!')


select_geni	SELECT	 insert into select_geni_out (id_instance, id_experiment, id_activity, adjacency, laplacian, slaplacian, adjacencyB, laplacianB, slaplacianB, optifunc, caixa1, gorder, mindegree, maxdegree, trianglefree, allowdiscgraphs, biptonly, g6file, g6fileid, g6splitedfile, maxresults, chromatic, chromaticb, click, clickb, largestdegree, numedges) select %ID_PIP%, %ID_EXP%, %ID_ACT%, awk_out.adjacency,awk_out.laplacian, awk_out.slaplacian, awk_out.adjacencyb, awk_out.laplacianb, awk_out.slaplacianb, awk_out.optifunc, awk_out.caixa1, awk_out.gorder, awk_out.mindegree, awk_out.maxdegree, awk_out.trianglefree, awk_out.allowdiscgraphs, awk_out.biptonly, awk_out.g6file, awk_out.g6fileid, awk_out.g6splitedfile, awk_out.maxresults, awk_out.chromatic, awk_out.chromaticb, awk_out.click, awk_out.clickb, awk_out.largestdegree ,awk_out.numedges from awk_out where awk_out.id_experiment = %ID_EXP% and ( awk_out.optifunc like '%omega%' or awk_out.optifunc like '%chi%' or awk_out.optifunc like '%SIZE%' or awk_out.optifunc like '%d!_%' ESCAPE '!' ) 


PORTAL_SELECT	SELECT	 	insert into select_out (id_instance, id_experiment, id_activity, optifunc, g6fileid, evaluatedvalue, maxresults, caixa1, gorder, g6splitedfile, function) select %ID_PIP%, %ID_EXP%, %ID_ACT%, optifunc, g6fileid, evaluatedvalue, maxresults, caixa1, gorder, g6splitedfile, function from ( WITH l AS ( SELECT CASE WHEN caixa1 = 'min' THEN maxresults ELSE 0 END AS lim_a, CASE WHEN caixa1 = 'max' THEN maxresults ELSE 0 END AS lim_d FROM evaluate_out where id_experiment = %ID_EXP% LIMIT 1 ) (select * from ( select eo.*,ak.g6splitedfile, row_number() over (partition by eo.gorder order by CAST(eo.evaluatedvalue as float) asc) as rownum from evaluate_out eo join awk_out ak on ak.g6fileid = eo.g6fileid where eo.id_experiment = %ID_EXP%) tmp where rownum <= (SELECT lim_a FROM l) ) union all ( select * from ( select eo.*,ak.g6splitedfile, row_number() over (partition by eo.gorder order by CAST(eo.evaluatedvalue as float) desc) as rownum from evaluate_out eo join awk_out ak on ak.g6fileid = eo.g6fileid where eo.id_experiment = %ID_EXP%) tmp where rownum <= (SELECT lim_d FROM l) ) ) as t1 where id_experiment = %ID_EXP% 


PORTAL_JOIN	SELECT	 	insert into filter_out (id_instance, id_experiment, id_activity, optifunc, gorder, g6file, g6splitedfile, g6fileid, workfile, caixa1, maxresults) select %ID_PIP%, %ID_EXP%, %ID_ACT%, t1.optifunc, t1.gorder, t1.g6file, t1.g6splitedfile, t1.g6fileid, t1.fileid, t1.caixa1, t1.maxresults from ( select eso.optifunc,eso.gorder,eso.g6file,eso.g6splitedfile,eso.g6fileid, eso.eigsolve as fileid, eso.caixa1, eso.maxresults from eigsolve_out eso where eso.id_experiment = %ID_EXP% union select so.optifunc,so.gorder,so.g6file,so.g6splitedfile,so.g6fileid, so.sagefile as fileid, so.caixa1, so.maxresults from sage_out so where so.id_experiment = %ID_EXP%) as t1 where t1.fileid is not null 	


MOUNT_RESULTS	SELECT	 	insert into portal_result_files(id_instance, id_experiment, id_activity, workfile, gorder) select %ID_PIP%, %ID_EXP%, %ID_ACT%, workfile, gorder from ( select ao.g6splitedfile as workfile, ao.gorder from awk_out ao where ao.g6fileid in ( select g6fileid from select_out ) and ao.id_experiment = %ID_EXP% union all select pdffile as workfile, gorder from pdfcreator_out where id_experiment = %ID_EXP%) as t1  


